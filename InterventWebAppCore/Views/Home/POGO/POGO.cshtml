@using InterventWebApp
@model InterventWebApp.LoginModel
@{
    ViewBag.Title = "LandingPages";
    Layout = "~/Views/Shared/_AnonymousLayout.cshtml";
    ViewBag.Details = "LandingPage";
}

@Html.Partial("POGO/_POGOHeader", new ViewDataDictionary(ViewData) { { "MenuClass", "" } })

<section class="lmc-index lmc-wrapper title-casing">
    <section class="lmc-login">
        <div class="grid-container">
            <div class="grid-x">
                <div class="cell large-11">
                    <div class="grid-x grid-margin-x">
                        <div class="cell medium-6">
                            <h1>@Translate.Message("L1893")</h1>
                            <p>
                                @Translate.Message("L428")
                            </p>
                            <img src="~/Images/lmc/bicycle-girl.svg" alt="" class="bicycle-girl" />
                        </div>
						<div class="cell medium-6 large-5 large-offset-1" id="login-form-wrapper">
							<div class="form-white-bg hide-for-small-only">

								<form id="inline-login-form" class="form-login-box" data-abide novalidate>
									<!--Login Form-->
									<div data-alert="" id="inline-login-form-inline-login-error" class="callout alert alert-box hide"></div>
									<input type="hidden" id="organizationEmail" name="OrganizationEmail" value="@TempData.Peek("OrgContactEmail").ToString()" />
									<div>
										<label>@Translate.Message("L572")</label>
										@Html.TextBoxFor(m => m.UserName, new Dictionary<string, object> { { "placeholder", Translate.Message("L986") }, { "required", "required" }, { "id", "loginUserName" } })
										<small class="form-error">@Translate.Message("L463")</small>
									</div>

									<div class="password-field-box">
										<label>@Translate.Message("L466")</label>
										@Html.PasswordFor(m => m.Password, new Dictionary<string, object> { { "placeholder", Translate.Message("L466") }, { "required", "required" } })
										<span class="toggle-password fa fa-fw fa-eye"></span>
										<small class="form-error">@Translate.Message("L464")</small>
									</div>

									<p><a href="#" data-open="forgot-password-modal">@Translate.Message("L465")</a></p>

									<div class="lmc-login-container">
										<button type="submit" class="button expanded">
											<div class="loading-spinner hide" show-if-submitting></div>
											@Translate.Message("L426")
										</button>
									</div>

									<input class="DeviceId" type="hidden" id="DeviceId" name="DeviceId" value="" />
									<!-- <div class="lmc-join-container">
				<p>@Translate.Message("L3223")</p>
				<a href="" id="inlineSignUp" class="button hollow expanded">@Translate.Message("L443")</a>
			</div> -->
								</form>
								
								 <div id="device-verification-inline-login-form"></div>
							</div>

							<div class="show-for-small-only lmc-mobile-form">
								<button class="button expanded" data-open="login-modal">@Translate.Message("L426")</button>
							</div>
						</div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!--Login section ends-->

    <section class="lmc-offers-section">
        <div class="grid-container">
            <div class="grid-x grid-margin-x text-center" data-equalizer>
                <div class="cell medium-4">
                    <div class="column-container">
                        <img src="~/Images/lmc/columns-image-1.png" alt="" />
                        <h4 data-equalizer-watch>@Translate.Message("L3224")</h4>
                        <p data-equalizer-watch>@Translate.Message("L3225")</p>
                    </div>
                </div>
                <div class="cell medium-4">
                    <div class="column-container">
                        <img src="~/Images/lmc/columns-image-2.png" alt="" />
                        <h4 data-equalizer-watch>@Translate.Message("L3226")</h4>
                        <p data-equalizer-watch>@Translate.Message("L454")</p>
                    </div>
                </div>
                <div class="cell medium-4">
                    <div class="column-container">
                        <img src="~/Images/lmc/columns-image-3.png" alt="" />
                        <h4 data-equalizer-watch>@Translate.Message("L3228")</h4>
                        <p data-equalizer-watch>@Translate.Message("L3229")</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="lmc-contact-section">
        <div class="grid-container">
            <div class="grid-x align-center">
                <div class="cell large-6 medium-9">
                    <h2>@Translate.Message("L3460")</h2>
                    <form id="contact-form" data-abide novalidate>
                        <div class="grid-x grid-margin-x grid-margin-y">
                            <input type="hidden" id="organizationEmail" name="OrganizationEmail" value="@TempData.Peek("OrgContactEmail").ToString()" />
                            <input type="hidden" id="subject" name="subject" value="POGO" />
                            <div class="cell medium-6">
                                <label>@Translate.Message("L3233")</label>
                                <input type="text" id="name" name="name" required />
                                <small class="form-error">@Translate.Message("L480")</small>
                            </div>
                            <div class="cell medium-6">
                                <label>@Translate.Message("L572")</label>
                                <input type="email" id="email" name="email" required />
                                <small class="form-error">@Translate.Message("L480")</small>
                            </div>
                            <div class="cell">
                                <label>@Translate.Message("L3234")</label>
                                <textarea id="meassage" name="meassage" required></textarea>
                                <small class="form-error">@Translate.Message("L480")</small>
                            </div>
                            <div class="cell text-center">
                                <button type="submit" class="button">@Translate.Message("L3235")</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>
    <!--Contact section ends-->

    <section class="lmc-get-started">
        <div class="grid-container">
            <div class="grid-x align-center">
				<div class="cell large-6 medium-9 text-center ">
					<h2>@Translate.Message("L3680")</h2>
				</div>
            </div>
        </div>
    </section>
    <!--Get started section ends-->
</section>

<!-- Error Modal-->
<div id="error-modal" class="reveal small" data-reveal>
    <div class="grid-x grid-margin-x">
        <div class="cell small-12">
            <h2 class="text-center"></h2>
            <p>
                <span id="error-message-genericmodal"></span>
            </p>
        </div>
    </div>
    <button class="close-button" data-close aria-label="Close modal" type="button">
        <span aria-hidden="true">&times;</span>
    </button>
</div>

<div id="lmc-mobile-signup" class="reveal lmc-form" data-reveal data-close-on-click="false" data-close-on-esc="false">
    @Html.Partial("_UpdatedSignUp")
    <a class="close-button" data-close id="close">&#215;</a>
</div>

@Html.Partial("_ResetPassword", new ViewDataDictionary(ViewData) { { "LMCClass", "lmc-forgot-password" } })

@Html.Partial("_EmailConfirmation", new ViewDataDictionary(ViewData) { { "LMCClass", "lmc-forgot-password" } })

@Html.Partial("_ForgotPassword", new ViewDataDictionary(ViewData) { { "LMCClass", "lmc-forgot-password" } })

@Html.Partial("_NewLogin", new ViewDataDictionary(ViewData) { { "ShowSignUp", "True" }, { "ShowDeviceVerification", "True"} })

@Html.Partial("_ResendConfirmEmail", new ViewDataDictionary(ViewData) { { "LMCClass", "lmc-forgot-password" } })

<script>
    Foundation.Abide.defaults.validators['validateInConfirmEmail'] = function ($el, required, parent) {
        var email = $("#inemail").val();
        var confirmemail = $("#inconfirmemail").val();
        if (email.toUpperCase() === confirmemail.toUpperCase())
            return true;
        else
            return false;
    };

    $(document).ready(function () {
        $('#contact-form').foundation();
        $('#contact-form')
            //When Not Valid
            .on('forminvalid.zf.abide', function () {
            })
            //When Valid
            .on('formvalid.zf.abide', function () {
                $.ajax({
                    url: "@Url.Action("SendUserMessage", "Home")",
                    type: 'POST',
                    dataType: "json",
                    data: $("#contact-form").serialize(),
                    success: function (data) {
                        if (data == "success") {
                            $('#contact-form :input').val("");
                            alert("@Translate.Message("L3461")");
                        }
                    }
                }).fail(function (jqXHR, textStatus, errorThrown) {
                    DisplayError(jqXHR.status);
                });
            }).on("submit", function (ev) {
                    ev.preventDefault();
            })
            $("#sign-up-inlineform").foundation();
            //When Not Valid
            $("#sign-up-inlineform")
            .on('forminvalid.zf.abide', function () {
                var invalid_fields = $(this).find('[data-invalid]');
             })
            //When Valid
                .on('formvalid.zf.abide', function () {
                    if (document.getElementById('inserviceagreement').checked) {
                        $("#sign-up-inlineform").find('input[id="inpassword"]').val(window.btoa(Math.random().toString(36).substring(2, 8) + $("#sign-up-inlineform").find('input[id="inpassword"]').val()));
                        var tempDOB = ($("#inMonth").val() + "/" + $("#inDay").val() + "/" + $("#inYear").val());
                        $('#inDOB').val(tempDOB);
                        $('#SignUpDate').val(toSystemDateFormat(new Date().toLocaleDateString()));
                    $.ajax({
                        url: "@Url.Action("Register", "Account")",
                        type: 'POST',
                        dataType: "json",
                        data: $("#sign-up-inlineform").serialize(),
                        success: function (data) {
                            var password = $('#inpassword').val();
                            $("#sign-up-inlineform").find('input[id="inpassword"]').val("");
                            $("#sign-up-inlineform").find('input[id="inpassword"]').trigger('keypress');
                            $("#sign-up-inlineform").find('input[id="inpassword"]').trigger('keyup');
                            $("#sign-up-inlineform").find('input[id="inconfirmpassword"]').val("");
                            if (data.Success) {
                                var username = $('#inemail').val();
                                var organizationEmail = $('#supportEmail').val();
                                var loginURL = "@Url.Action("Login", "Account")";
                                var streamURL = "@Url.Action("Stream", "Participant")";
                                validateSignIn(data, username, password, organizationEmail, loginURL, streamURL);
                                $('.register-modal-email').text($('#inemail').val());
                                document.getElementById("sign-up-inlineform").reset();
                            }
                            else {
                                $('#error-modal').foundation('open');
                                $("#error-message-genericmodal").text(data.ErrorMessage);
                            }

                        }
                    }).fail(function (jqXHR, textStatus, errorThrown) {
                            DisplayError(jqXHR.status);
                        });
                }
            }).on("submit", function (ev) {
                    ev.preventDefault();
                })
            if ("@ViewData["SignUp"]" == "True")
            {
                $("#inlineSignUp").trigger('click');
            }
    });

</script>

<script>
    $("input#login-switch").on('click', function () {
        $(".form-login-box, .form-signup-box").toggleClass("hide");
    });

    function openSignUp(e) {
        e.preventDefault();
		$("html, body").animate({
			scrollTop: 0
        }, "fast");

        if ($("#sign-up-inlineform").hasClass("hide")) {
            $(".form-login-box, .form-signup-box").toggleClass("hide");
            $("input#login-switch").prop("checked", true);
        }
    }
</script>
<script type="text/javascript" src="@Url.Content("~/Scripts/PasswordValidation.js")?v=@CommonUtility.GetRandom()"></script>